<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Universe - Welcome</title>
    <!-- <link rel="stylesheet" href="style.css" /> -->
    <link rel="stylesheet" href="sign-in.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="theme-switch">
      <i class="fas fa-moon"></i>
    </div>

    <div class="form-container">
      <p class="title">Welcome back</p>
      <form class="form" id="loginForm">
        <input type="email" class="input" placeholder="Email" id="emailInput" required />
        <input type="password" class="input" placeholder="Password" id="passwordInput" required />
        <p class="page-link">
          <span class="page-link-label">Forgot Password?</span>
        </p>
        <button type="submit" class="form-btn">Log in</button>
        <div id="loginMessage" style="margin-top: 10px; text-align: center;"></div>
      </form>
      <p class="sign-up-label">
        Don't have an account?<span class="sign-up-link"><a href="sign-up1.html">Sign up</a></span>
      </p>
             <div class="buttons-container">
         <div class="apple-login-button" id="appleLoginBtn">
           <svg
             stroke="currentColor"
             fill="currentColor"
             stroke-width="0"
             class="apple-icon"
             viewBox="0 0 1024 1024"
             height="1em"
             width="1em"
             xmlns="http://www.w3.org/2000/svg"
           >
             <path
               d="M747.4 535.7c-.4-68.2 30.5-119.6 92.9-157.5-34.9-50-87.7-77.5-157.3-82.8-65.9-5.2-138 38.4-164.4 38.4-27.9 0-91.7-36.6-141.9-36.6C273.1 298.8 163 379.8 163 544.6c0 48.7 8.9 99 26.7 150.8 23.8 68.2 109.6 235.3 199.1 232.6 46.8-1.1 79.9-33.2 140.8-33.2 59.1 0 89.7 33.2 141.9 33.2 90.3-1.3 167.9-153.2 190.5-221.6-121.1-57.1-114.6-167.2-114.6-170.7zm-105.1-305c50.7-60.2 46.1-115 44.6-134.7-44.8 2.6-96.6 30.5-126.1 64.8-32.5 36.8-51.6 82.3-47.5 133.6 48.4 3.7 92.6-21.2 129-63.7z"
             ></path>
           </svg>
           <span>Log in with Apple</span>
         </div>
         <div class="google-login-button" id="googleLoginBtn">
           <svg
             stroke="currentColor"
             fill="currentColor"
             stroke-width="0"
             version="1.1"
             x="0px"
             y="0px"
             class="google-icon"
             viewBox="0 0 48 48"
             height="1em"
             width="1em"
             xmlns="http://www.w3.org/2000/svg"
           >
             <path
               fill="#FFC107"
               d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
	c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24
	c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"
             ></path>
             <path
               fill="#FF3D00"
               d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657
	C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"
             ></path>
             <path
               fill="#4CAF50"
               d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
	c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"
             ></path>
             <path
               fill="#1976D2"
               d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
	c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"
             ></path>
           </svg>
           <span>Log in with Google</span>
         </div>
       </div>
    </div>

    <script>
      // Login functionality
      document.getElementById('loginForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const email = document.getElementById('emailInput').value.trim();
        const password = document.getElementById('passwordInput').value;
        const loginMessage = document.getElementById('loginMessage');
        
        // Clear previous messages
        loginMessage.textContent = '';
        loginMessage.style.color = '';
        
        // Validate inputs
        if (!email || !password) {
          loginMessage.textContent = 'Please fill in all fields';
          loginMessage.style.color = 'red';
          return;
        }
        
        // Get all stored user accounts from local storage
        const allAccounts = JSON.parse(localStorage.getItem('allUserAccounts') || '[]');
        
        if (allAccounts.length === 0) {
          loginMessage.textContent = 'No registered users found. Please sign up first.';
          loginMessage.style.color = 'red';
          return;
        }
        
        try {
          // Find user account with matching email
          const userAccount = allAccounts.find(account => account.email === email);
          
          if (!userAccount) {
            loginMessage.textContent = 'No account found with this email. Please check your email or sign up.';
            loginMessage.style.color = 'red';
            return;
          }
          
          // Check if registration is complete
          if (!userAccount.registrationComplete) {
            loginMessage.textContent = 'Registration not completed. Please complete your registration first.';
            loginMessage.style.color = 'red';
            return;
          }
          
          // Check if email and password match
          if (userAccount.email === email && userAccount.password === password) {
            // Login successful
            loginMessage.textContent = 'Login successful! Redirecting...';
            loginMessage.style.color = 'green';
            
            // Store login status
            localStorage.setItem('userLoggedIn', 'true');
            localStorage.setItem('currentUser', JSON.stringify({
              email: userAccount.email,
              fullName: userAccount.fullName,
              username: userAccount.username,
              loginTime: new Date().toISOString()
            }));
            
            // Redirect to main page after a short delay
            setTimeout(() => {
              window.location.href = 'firstpage.html';
            }, 1500);
            
          } else {
            // Login failed
            loginMessage.textContent = 'Invalid email or password. Please try again.';
            loginMessage.style.color = 'red';
          }
          
        } catch (error) {
          loginMessage.textContent = 'Error reading user data. Please try again.';
          loginMessage.style.color = 'red';
          console.error('Error parsing user data:', error);
        }
      });
      
             // Check if user is already logged in
       window.addEventListener('load', function() {
         const isLoggedIn = localStorage.getItem('userLoggedIn');
         if (isLoggedIn === 'true') {
           // User is already logged in, redirect to main page
           window.location.href = 'firstpage.html';
         }
       });
       
               // Apple Login functionality
        document.getElementById('appleLoginBtn').addEventListener('click', function() {
          const loginMessage = document.getElementById('loginMessage');
          
          // Clear previous messages
          loginMessage.textContent = '';
          loginMessage.style.color = '';
          
          // Prompt user for Apple ID
          const appleId = prompt('Please enter your Apple ID:');
          if (!appleId) {
            loginMessage.textContent = 'Apple ID is required for login.';
            loginMessage.style.color = 'red';
            return;
          }
          
          // Prompt user for Apple ID password
          const applePassword = prompt('Please enter your Apple ID password:');
          if (!applePassword) {
            loginMessage.textContent = 'Apple ID password is required for login.';
            loginMessage.style.color = 'red';
            return;
          }
          
          // Simulate Apple login process
          loginMessage.textContent = 'Connecting to Apple...';
          loginMessage.style.color = 'blue';
          
          // Simulate Apple authentication (in real app, this would use Apple's Sign In API)
          setTimeout(() => {
            // Check if Apple user already exists with this Apple ID
            const allAccounts = JSON.parse(localStorage.getItem('allUserAccounts') || '[]');
            const existingAppleUser = allAccounts.find(account => account.loginMethod === 'apple' && account.appleId === appleId);
            
            if (existingAppleUser) {
              // Verify password (in real app, this would be handled by Apple's authentication)
              if (existingAppleUser.applePassword === applePassword) {
                // Login successful
                loginMessage.textContent = 'Apple login successful! Redirecting...';
                loginMessage.style.color = 'green';
                
                // Store login status
                localStorage.setItem('userLoggedIn', 'true');
                localStorage.setItem('currentUser', JSON.stringify({
                  email: existingAppleUser.email,
                  fullName: existingAppleUser.fullName,
                  username: existingAppleUser.username,
                  loginTime: new Date().toISOString(),
                  loginMethod: 'apple'
                }));
                
                // Redirect to main page after a short delay
                setTimeout(() => {
                  window.location.href = 'firstpage.html';
                }, 1500);
              } else {
                loginMessage.textContent = 'Invalid Apple ID or password. Please try again.';
                loginMessage.style.color = 'red';
              }
            } else {
              // Create new Apple user account
              const appleUser = {
                fullName: 'Apple User',
                username: 'apple_user_' + Math.random().toString(36).substr(2, 9),
                email: appleId + '@apple.com',
                appleId: appleId,
                applePassword: applePassword,
                dob: '1990-01-01',
                gender: 'prefer-not-to-say',
                phoneNumber: '',
                address: '',
                password: 'apple_auth_' + Math.random().toString(36).substr(2, 9),
                agreeTerms: true,
                interests: ['socialmedia'],
                registrationComplete: true,
                registrationDate: new Date().toISOString(),
                loginMethod: 'apple'
              };
              
              // Add new Apple user to accounts
              allAccounts.push(appleUser);
              localStorage.setItem('allUserAccounts', JSON.stringify(allAccounts));
              
              // Login successful
              loginMessage.textContent = 'Apple account created and login successful! Redirecting...';
              loginMessage.style.color = 'green';
              
              // Store login status
              localStorage.setItem('userLoggedIn', 'true');
              localStorage.setItem('currentUser', JSON.stringify({
                email: appleUser.email,
                fullName: appleUser.fullName,
                username: appleUser.username,
                loginTime: new Date().toISOString(),
                loginMethod: 'apple'
              }));
              
              // Redirect to main page after a short delay
              setTimeout(() => {
                window.location.href = 'firstpage.html';
              }, 1500);
            }
            
          }, 2000);
        });
       
               // Google Login functionality
        document.getElementById('googleLoginBtn').addEventListener('click', function() {
          const loginMessage = document.getElementById('loginMessage');
          
          // Clear previous messages
          loginMessage.textContent = '';
          loginMessage.style.color = '';
          
          // Prompt user for Google email
          const googleEmail = prompt('Please enter your Google email address:');
          if (!googleEmail) {
            loginMessage.textContent = 'Google email is required for login.';
            loginMessage.style.color = 'red';
            return;
          }
          
          // Validate email format
          const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          if (!emailRegex.test(googleEmail)) {
            loginMessage.textContent = 'Please enter a valid email address.';
            loginMessage.style.color = 'red';
            return;
          }
          
          // Prompt user for Google password
          const googlePassword = prompt('Please enter your Google account password:');
          if (!googlePassword) {
            loginMessage.textContent = 'Google password is required for login.';
            loginMessage.style.color = 'red';
            return;
          }
          
          // Simulate Google login process
          loginMessage.textContent = 'Connecting to Google...';
          loginMessage.style.color = 'blue';
          
          // Simulate Google authentication (in real app, this would use Google's OAuth API)
          setTimeout(() => {
            // Check if Google user already exists with this email
            const allAccounts = JSON.parse(localStorage.getItem('allUserAccounts') || '[]');
            const existingGoogleUser = allAccounts.find(account => account.loginMethod === 'google' && account.email === googleEmail);
            
            if (existingGoogleUser) {
              // Verify password (in real app, this would be handled by Google's authentication)
              if (existingGoogleUser.googlePassword === googlePassword) {
                // Login successful
                loginMessage.textContent = 'Google login successful! Redirecting...';
                loginMessage.style.color = 'green';
                
                // Store login status
                localStorage.setItem('userLoggedIn', 'true');
                localStorage.setItem('currentUser', JSON.stringify({
                  email: existingGoogleUser.email,
                  fullName: existingGoogleUser.fullName,
                  username: existingGoogleUser.username,
                  loginTime: new Date().toISOString(),
                  loginMethod: 'google'
                }));
                
                // Redirect to main page after a short delay
                setTimeout(() => {
                  window.location.href = 'firstpage.html';
                }, 1500);
              } else {
                loginMessage.textContent = 'Invalid Google email or password. Please try again.';
                loginMessage.style.color = 'red';
              }
            } else {
              // Create new Google user account
              const googleUser = {
                fullName: 'Google User',
                username: 'google_user_' + Math.random().toString(36).substr(2, 9),
                email: googleEmail,
                googlePassword: googlePassword,
                dob: '1990-01-01',
                gender: 'prefer-not-to-say',
                phoneNumber: '',
                address: '',
                password: 'google_auth_' + Math.random().toString(36).substr(2, 9),
                agreeTerms: true,
                interests: ['socialmedia'],
                registrationComplete: true,
                registrationDate: new Date().toISOString(),
                loginMethod: 'google'
              };
              
              // Add new Google user to accounts
              allAccounts.push(googleUser);
              localStorage.setItem('allUserAccounts', JSON.stringify(allAccounts));
              
              // Login successful
              loginMessage.textContent = 'Google account created and login successful! Redirecting...';
              loginMessage.style.color = 'green';
              
              // Store login status
              localStorage.setItem('userLoggedIn', 'true');
              localStorage.setItem('currentUser', JSON.stringify({
                email: googleUser.email,
                fullName: googleUser.fullName,
                username: googleUser.username,
                loginTime: new Date().toISOString(),
                loginMethod: 'google'
              }));
              
              // Redirect to main page after a short delay
              setTimeout(() => {
                window.location.href = 'firstpage.html';
              }, 1500);
            }
            
          }, 2000);
        });
    </script>
    
    <script src="theme.js"></script>
  </body>
</html>

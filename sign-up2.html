<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Universe - Sign Up</title>
    <link rel="stylesheet" href="sign-up1.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="theme-switch">
      <i class="fas fa-moon"></i>
    </div>
    <div class="form-container">
      <p class="title">Create An Account</p>
      <form class="form" id="registrationForm">
        <input type="text" class="input" placeholder="Phone Number" required />
        <input type="text" class="input" placeholder="Address (Optional)" />

        <input
          type="password"
          id="password"
          name="password"
          required
          class="input"
          placeholder="Password"
        />

        <input
          type="password"
          id="confirmPassword"
          name="confirmPassword"
          class="input"
          placeholder="Confirm Password"
          required
        />
        <span id="passwordError" style="color: red"></span>

        <button type="submit" class="form-btn">Next</button>
      </form>
    </div>
    <script>
      // Load saved data when page loads
      window.addEventListener('load', function() {
        const savedData = JSON.parse(localStorage.getItem('userRegistrationData') || '{}');
        
        // If registration is already complete, clear the form for new registration
        if (savedData.registrationComplete) {
          // Clear all form fields
          document.querySelector('input[placeholder="Phone Number"]').value = '';
          document.querySelector('input[placeholder="Address (Optional)"]').value = '';
          document.getElementById('password').value = '';
          document.getElementById('confirmPassword').value = '';
          
          // Clear the temporary registration data to start fresh
          localStorage.removeItem('userRegistrationData');
          return;
        }
        
        // Load saved data for incomplete registration
        if (savedData.phoneNumber) {
          document.querySelector('input[placeholder="Phone Number"]').value = savedData.phoneNumber;
        }
        if (savedData.address) {
          document.querySelector('input[placeholder="Address (Optional)"]').value = savedData.address;
        }
      });

      document.getElementById("registrationForm").addEventListener("submit", function (e) {
        e.preventDefault();

        const phoneNumber = document
          .querySelector('input[placeholder="Phone Number"]')
          .value.trim();
        const address = document
          .querySelector('input[placeholder="Address (Optional)"]')
          .value.trim();
        const password = document.getElementById("password").value;
        const confirmPassword = document.getElementById("confirmPassword").value;

        if (password !== confirmPassword) {
          document.getElementById("passwordError").textContent = "Passwords do not match!";
          return;
        }

        if (phoneNumber && password && confirmPassword) {
          // Get existing data from local storage
          const existingData = JSON.parse(localStorage.getItem('userRegistrationData') || '{}');
          
          // Add new data to existing data
          const userData = {
            ...existingData,
            phoneNumber: phoneNumber,
            address: address,
            password: password
          };
          
          localStorage.setItem('userRegistrationData', JSON.stringify(userData));
          window.location.href = "sign-up3.html";
        } 
      });
    </script>
    <script src="userDataManager.js"></script>
    <script src="theme.js"></script>
  </body>
</html>
